define(["./core","./var/document","./var/isFunction","./var/rnothtmlwhite","./ajax/var/location","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseXML","./event/trigger","./deferred","./serialize"],function(e,t,a,r,o,n,s){"use strict";function i(e){return function(t,o){"string"!=typeof t&&(o=t,t="*");var n,s=0,i=t.toLowerCase().match(r)||[];if(a(o))for(;n=i[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(o)):(e[n]=e[n]||[]).push(o)}}function c(t,a,r,o){function n(c){var d;return s[c]=!0,e.each(t[c]||[],function(e,t){var c=t(a,r,o);return"string"!=typeof c||i||s[c]?i?!(d=c):void 0:(a.dataTypes.unshift(c),n(c),!1)}),d}var s={},i=t===m;return n(a.dataTypes[0])||!s["*"]&&n("*")}function d(t,a){var r,o,n=e.ajaxSettings.flatOptions||{};for(r in a)void 0!==a[r]&&((n[r]?t:o||(o={}))[r]=a[r]);return o&&e.extend(!0,t,o),t}var f=/%20/g,p=/#.*$/,u=/([?&])_=[^&]*/,l=/^(.*?):[ \t]*([^\r\n]*)$/gm,h=/^(?:GET|HEAD)$/,x=/^\/\//,y={},m={},g="*/".concat("*"),v=t.createElement("a");return v.href=o.href,e.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:o.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(o.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":g,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":e.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,a){return a?d(d(t,e.ajaxSettings),a):d(e.ajaxSettings,t)},ajaxPrefilter:i(y),ajaxTransport:i(m),ajax:function(a,i){function d(t,a,r,o){var n,s,i,c,d,f=a;H||(H=!0,S&&window.clearTimeout(S),j=void 0,w=o||"",J.readyState=t>0?4:0,n=t>=200&&t<300||304===t,r&&(c=function(e,t,a){for(var r,o,n,s,i=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in i)if(i[o]&&i[o].test(r)){c.unshift(o);break}if(c[0]in a)n=c[0];else{for(o in a){if(!c[0]||e.converters[o+" "+c[0]]){n=o;break}s||(s=o)}n=n||s}if(n)return n!==c[0]&&c.unshift(n),a[n]}(D,J,r)),c=function(e,t,a,r){var o,n,s,i,c,d={},f=e.dataTypes.slice();if(f[1])for(s in e.converters)d[s.toLowerCase()]=e.converters[s];for(n=f.shift();n;)if(e.responseFields[n]&&(a[e.responseFields[n]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=n,n=f.shift())if("*"===n)n=c;else if("*"!==c&&c!==n){if(!(s=d[c+" "+n]||d["* "+n]))for(o in d)if((i=o.split(" "))[1]===n&&(s=d[c+" "+i[0]]||d["* "+i[0]])){!0===s?s=d[o]:!0!==d[o]&&(n=i[0],f.unshift(i[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+c+" to "+n}}}return{state:"success",data:t}}(D,c,J,n),n?(D.ifModified&&((d=J.getResponseHeader("Last-Modified"))&&(e.lastModified[T]=d),(d=J.getResponseHeader("etag"))&&(e.etag[T]=d)),204===t||"HEAD"===D.type?f="nocontent":304===t?f="notmodified":(f=c.state,s=c.data,n=!(i=c.error))):(i=f,!t&&f||(f="error",t<0&&(t=0))),J.status=t,J.statusText=(a||f)+"",n?F.resolveWith(q,[s,f,J]):F.rejectWith(q,[J,f,i]),J.statusCode(N),N=void 0,L&&E.trigger(n?"ajaxSuccess":"ajaxError",[J,D,n?s:i]),O.fireWith(q,[J,f]),L&&(E.trigger("ajaxComplete",[J,D]),--e.active||e.event.trigger("ajaxStop")))}"object"==typeof a&&(i=a,a=void 0),i=i||{};var j,T,w,b,S,C,H,L,M,R,D=e.ajaxSetup({},i),q=D.context||D,E=D.context&&(q.nodeType||q.jquery)?e(q):e.event,F=e.Deferred(),O=e.Callbacks("once memory"),N=D.statusCode||{},$={},k={},A="canceled",J={readyState:0,getResponseHeader:function(e){var t;if(H){if(!b)for(b={};t=l.exec(w);)b[t[1].toLowerCase()+" "]=(b[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=b[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return H?w:null},setRequestHeader:function(e,t){return null==H&&(e=k[e.toLowerCase()]=k[e.toLowerCase()]||e,$[e]=t),this},overrideMimeType:function(e){return null==H&&(D.mimeType=e),this},statusCode:function(e){var t;if(e)if(H)J.always(e[J.status]);else for(t in e)N[t]=[N[t],e[t]];return this},abort:function(e){var t=e||A;return j&&j.abort(t),d(0,t),this}};if(F.promise(J),D.url=((a||D.url||o.href)+"").replace(x,o.protocol+"//"),D.type=i.method||i.type||D.method||D.type,D.dataTypes=(D.dataType||"*").toLowerCase().match(r)||[""],null==D.crossDomain){C=t.createElement("a");try{C.href=D.url,C.href=C.href,D.crossDomain=v.protocol+"//"+v.host!=C.protocol+"//"+C.host}catch(e){D.crossDomain=!0}}if(D.data&&D.processData&&"string"!=typeof D.data&&(D.data=e.param(D.data,D.traditional)),c(y,D,i,J),H)return J;(L=e.event&&D.global)&&0==e.active++&&e.event.trigger("ajaxStart"),D.type=D.type.toUpperCase(),D.hasContent=!h.test(D.type),T=D.url.replace(p,""),D.hasContent?D.data&&D.processData&&0===(D.contentType||"").indexOf("application/x-www-form-urlencoded")&&(D.data=D.data.replace(f,"+")):(R=D.url.slice(T.length),D.data&&(D.processData||"string"==typeof D.data)&&(T+=(s.test(T)?"&":"?")+D.data,delete D.data),!1===D.cache&&(T=T.replace(u,"$1"),R=(s.test(T)?"&":"?")+"_="+n+++R),D.url=T+R),D.ifModified&&(e.lastModified[T]&&J.setRequestHeader("If-Modified-Since",e.lastModified[T]),e.etag[T]&&J.setRequestHeader("If-None-Match",e.etag[T])),(D.data&&D.hasContent&&!1!==D.contentType||i.contentType)&&J.setRequestHeader("Content-Type",D.contentType),J.setRequestHeader("Accept",D.dataTypes[0]&&D.accepts[D.dataTypes[0]]?D.accepts[D.dataTypes[0]]+("*"!==D.dataTypes[0]?", "+g+"; q=0.01":""):D.accepts["*"]);for(M in D.headers)J.setRequestHeader(M,D.headers[M]);if(D.beforeSend&&(!1===D.beforeSend.call(q,J,D)||H))return J.abort();if(A="abort",O.add(D.complete),J.done(D.success),J.fail(D.error),j=c(m,D,i,J)){if(J.readyState=1,L&&E.trigger("ajaxSend",[J,D]),H)return J;D.async&&D.timeout>0&&(S=window.setTimeout(function(){J.abort("timeout")},D.timeout));try{H=!1,j.send($,d)}catch(e){if(H)throw e;d(-1,e)}}else d(-1,"No Transport");return J},getJSON:function(t,a,r){return e.get(t,a,r,"json")},getScript:function(t,a){return e.get(t,void 0,a,"script")}}),e.each(["get","post"],function(t,r){e[r]=function(t,o,n,s){return a(o)&&(s=s||n,n=o,o=void 0),e.ajax(e.extend({url:t,type:r,dataType:s,data:o,success:n},e.isPlainObject(t)&&t))}}),e});